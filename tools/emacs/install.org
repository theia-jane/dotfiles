#+TITLE: Emacs Install
#+PROPERTY: header-args :mkdirp yes

* Packages
** Local packages
=~/.local/emacs/site-lisp= is the a desitnation I'm adding to my =EMACSLOADPATH=
#+BEGIN_SRC bash :dir ~/.local/emacs
[ ! -d site-lisp ] \
 && mkdir site-lisp
#+END_SRC

I don't think this will ever /technically/ need to be run -- files tangled in this directory will probably exist.
** elpm
=elpm= helps me manage packages from a context outside of particular emacs config.
#+begin_src bash :dir ~/.local/src
[ ! -d elpm ] \
    && git clone https://github.com/tylerware/elpm

[ ! -f "${HOME}/bin/elpm" ] \
    && ln -s "$(pwd)/elpm/bin/elpm" "${HOME}/bin/elpm"

[ ! -f "${HOME}/.local/emacs/site-lisp/elpm.el" ] \
    && ln -s "$(pwd)/elpm/elpm.el" "${HOME}/.local/emacs/site-lisp/elpm.el"
#+end_src
* Chemacs
[[https://github.com/plexus/chemacs2][Chemacs]] is a bootloader that lets me switch between various emacs configs. It's useful for experimenting and trying things out.
#+BEGIN_SRC bash :dir ~/.config
if [ -e emacs ] && [ ! -f emacs/chemacs.el ]; then
    moved_name="/tmp/$(date +%s)"
    echo "$(pwd)/emacs exists and isn't chemacs. Moving to ${moved_name}"
    mv emacs "$move_name"
    rm -rf emacs
fi

[ ! -d emacs ] \
    && git clone https://github.com/plexus/chemacs2.git emacs
#+END_SRC

** Profiles
#+NAME: generate-profiles
#+BEGIN_SRC emacs-lisp 
(with-temp-buffer
  (let* ((distro-dir "~/.local/emacs/distros")
         (config-dir "~/.local/emacs/configs")
         (profiles `(("personal" . ((user-emacs-directory . ,(concat config-dir "/personal")))))))
    (insert (pp-to-string profiles))
    (write-region (point-min) (point-max) "~/.emacs-profiles.el")))
#+END_SRC

